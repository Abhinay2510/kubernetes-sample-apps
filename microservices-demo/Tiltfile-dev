ENVIRONMENT = "dev"
DOCKER_REGISTRY = "registry.digitalocean.com/microservices-demo/" + ENVIRONMENT

allow_k8s_contexts("<YOUR_REMOTE_DEV_CLUSTER_CONTEXT_HERE>")

docker_build(DOCKER_REGISTRY + "/cartservice", "src/cartservice/src")
docker_build(DOCKER_REGISTRY + "/checkoutservice", "src/checkoutservice")
docker_build(DOCKER_REGISTRY + "/currencyservice", "src/currencyservice")
docker_build(DOCKER_REGISTRY + "/emailservice", "src/emailservice")
docker_build(DOCKER_REGISTRY + "/frontend", "src/frontend")
docker_build(DOCKER_REGISTRY + "/paymentservice", "src/paymentservice")
docker_build(DOCKER_REGISTRY + "/productcatalogservice", "src/productcatalogservice")
docker_build(DOCKER_REGISTRY + "/recommendationservice", "src/recommendationservice")
docker_build(DOCKER_REGISTRY + "/shippingservice", "src/shippingservice")

k8s_yaml(kustomize("kustomize/dev"))

k8s_resource("frontend", port_forwards="9090")
